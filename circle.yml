machine:
  xcode:
    version: '7.1'
  environment:
    XCODE_WORKSPACE: "EPStackExample/EPStackExample.xcworkspace"
    LANG: en_US.UTF-8

dependencies:
  pre:
    - sudo gem install cocoapods --version 0.35.0
    # CocoaPods sometimes has issues using caches
    # between different versions of CocoaPods.
    - pod setup
    - pod install --project-directory=EPStackExample
  cache_directories:
    - "EPStackExample/Pods"
    
test:
  override:
    - set -o pipefail && xcodebuild -workspace EPStackExample/EPStackExample.xcworkspace -scheme
      EPStackExampleTests -sdk iphonesimulator -destination "platform=iOS Simulator,name=iPhone 6"
      GCC_INSTRUMENT_PROGRAM_FLOW_ARCS=YES GCC_GENERATE_TEST_COVERAGE_FILES=YES clean test | xcpretty -c 
      --report junit --output ${CIRCLE_TEST_REPORTS}/junit.xml
